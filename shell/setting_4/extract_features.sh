BATCH_NUMBER = 0

S4_CREATE_PATCHES = ['15dWuU21YB3qE5HeRw_CORrRPRZQUiJNf', '166FubrpZQJxIVOHUhgHlUUbfSfwFtDGR', '17-3vwOD0cAY2cBAi0S4Z4S7uCfV3YU4E', '17iKFDqKdfYutU8Zz3RdUiVroUFhVaWcs', '17mVeR_ehVF8HAaiyDbpyFueqQWVp-OGo', '17w0NBsEW21kgXPj8vYYjEO3PkMIrx3S3', '17xmrb1bLlZT2-S1DSe1xi3BZw-9AETDc', '186WJLHnWHgux7UgKRpbN798cTINHo1cA', '188QZyPKYpUuQa5skTwRZNl3QV6Wk5nov', '18CH4WPM9QaQ9QK1rnxD-y9RIcQwMo9lx', '15flTxg4x13JKtfQx-tSwW-CJVOuv7_v-', '15hzPg4MZE2pom8oTPgg61ZmgvAgWBcVL', '15kFkztdVcufT4Fx-X2RiJPUu6Yd7t-tD', '15qLfiYQB_-1wBeKsHL8MOp1ZmSQsCyXG', '15qypZqzU8py-858-NyrLSLhvXzxemVYJ', '15w1q5Nbbze6I1ifSx-wdIGx3302PhNET', '15yPdQqKfN9QgE2RqER1FSMAWR7pGmFj4', '161pe7BEPo8eQBptuqJllNcbp6KhpUOwI', '164eIJHKE2iFzlv6vENeZiuY7JQRi-xcz', '165wy_ZknjZRLRPPTVepAXaU6LmLlNQPS', '16Akw8TGvIGYfSYvt6FvAGTEipCyFOk2w', '16BBwD6L5B626PwnJupWaZ8BGTJS-IGdN', '16OFS7LNQQLnqTXCLmFXj6Ee3puL3iP2C', '16PtRYxuifHzm8xkt2QsrWMu3DRyokYoQ', '16Vsjn6VFrEs-1GWe7Bp-Uss59xY217ms', '16XjYWgeepDY79gvplA0gAhbjcDDDLW7u', '16d6dMJjTFJA15npENQKBZ8-INlc42ZjG', '16mXPkkqmLsdM1D1T1GZuB-jxXe7X1lA1', '16rk9lTamYFF_6yFAqYA39o9vxWn1dvFl', '16wehRrysPkvpJs4RJwzL-d0EBeMJ8vYP', '179SYftw94hsN2A-7SbntMiEjR3_peEo8', '17AuiFlt2gnGjpXSKpNZckTk3Vn1m19Wt', '17JH6pJFDmQwS7YRVmYzvB98JlChiHtNr', '17L4Pfu-igUEn5zxWTfibLJEHEp_OjoKl', '17OAu-SmdZAa3CNUqAniG3dPZk-lyE-Yj', '17OMIHRGu2B-m6_1A37KWDFRdnNV-2R9F', '17V-WBhBGVbcUfKLc5z-LlRFWIYTuPEXR', '17XtzfYNN3OvFN6t9PNLl_9B6hfH5lnCV', '17ehhUL695SXBEO2TFt3METXTKj0-BxWF', '17hoQPt4DbkH4ZLDx7Gk77eP3UTf2yo-2', '17iYwDLxKUEr_vbt2UnufdwketSxbstpg', '17k_RV1WV_VlACEqxlgH6eRAvriaPU69o', '17t-hX7AeL9dI9PFPecns2TZnHdgw-Qg2']
S4_EXTRACT_PATCHES = ['1AnEt5GxBlwVua6qBXS9MQq8ze2MknSKV', '1AnVqfWUIzQpB4WZd5ZyFNElbf1o2vHyb', '1Anj8rGwzfFq_AZU9y6nORnhMp40yCuiY', '1AmqZBtX5A5zmTJ-DieTRzG9o6I5wwP41', '1ApopqQuRcutftSWNFxTfbOtXAS7qFlMM', '1AzPDVxxMEOe3Qla8GqKYaIXj1_QOLAxe', '1B8OJYlkNbVAm-ljM8_UHhdbdpgByY2oP', '1BCUynfvwWlXvP5t9wjyzxH8rBOwXJEyp', '1AyZIX8Dy8nCuDcNC29VxLr3Lddb5dHH_', '1BD-jrxiH22ysF2Yp4jV8v-Ma9ZyoSEGF', '1BN3mT_MNiaNe26VSMCgba3H8NmpXe9Kw', '1BR-t_4dn07xkc1p9xnKitV-y1kJbftVP', '1BTC6ca-VkPfxOBTJxLC9w0Q_25sFAliO', '1B_DzmcclOYM4jG5o396JNt8uBjKnqpAO', '1BaWVxKtfRIqi3jELXHRGy-FjkZzZrfSP', '1BcCVeiKW3HgZHNHsQpVIBdl3jSGsIwnu', '1Bajf6flg0omk90EEpdadTInikRFPXCsL', '1Bbof02T8lwH4KZcMIo8pXZOWf6VTe6fM', '1BaejVPfm_FF_XxOp-bD4Zq5s8P5S9njJ', '1BdYgwuFQ1nqVgLWzv9JyNKfBKbXPzr2m', '1C2dHXYGFLsbZ6PkhVORxl-2KcVanhrjx', '1Bu_jiC5dd2XfsFrLsz8Z8oz16vNnn0L2', '1By44jmIry6BudnAPFHPnEy9lvJvdtLwa', '1BhU6FafMRhvm41v_c-YSekNdofnfeJmn', '1Bir9lUJ-wKs2wOh2pEfuhX30CEOPI2AZ', '1CA52li43iYkotNKtsHjsxQGhnqElcPHQ', '1C83Jed4Qbi9a8Cl5virxpneSrHgRBuOd', '1CI5e3etgKaZL2cV3xZ0lLV03HFcEziD3', '1CL6BJCmomsHbemGPYfxXLECeTCrlffMV', '1C72fwHTYezV6TWluH3ZTUtoWAog2zUHz', '1CP_Cc2iI3FdoyDSiYfzbVZR66iZ1mZiv', '1CZC5lUpMSJQg_61cVT9yiETGUmfuIGEI', '1CTh5gK8I8iJ2W7qEgFLIvem4UQKRMfiz', '1C_9q975hMk-p33164lENUo1xrk6ebWsz', '1CaH7AeV5GnLppJgfO7z7A5F0lEKd_ZFx', '1Cd7AfevNUHrPP2TMXyXr4NaYAq7uQ9Z3', '1CttxDQR3ch43T1q0AblfVCjkVQ_MWJ99', '1CifYj_XaA3_DQpcqOlIrvM3A_p3hegWR', '1Cm0WLi4T4DNfd85GzZfEsAKXI3AJ5Sx_', '1CfuRzzu-WfMF-vXERZptHhx-n14i3J5f', '1D0jMuWki0njq8NQ-riJN0ZV9dOevLsIi', '1D2IDCQpzt5nc6jXdi2_rSuUzKipqnT5F', '1D1bZuzdJn6RxXrMETCZ4p9nyET9I-w3t']

CREATE_PATCH_FID = S4_CREATE_PATCHES[BATCH_NUMBER]
EXTRACT_PATCH_FID = S4_EXTRACT_PATCHES[BATCH_NUMBER]

ACCESS_TOKEN = "ya29.a0AeXRPp5H6_pLzE9N8ynohe2jPPfywInWQouxSlcB5JA2nrR1Pe9eYDQQgDkxMa1yAMZNOHB62mmpeRfGeDfLnx1rOM91ZMMuR2l7drdo0qU3LySUj5yorE3Lly0Wvm0aUr8vXY2_AQTNa6_5Tt3_i2FFFZh5I1BRcPW7j-8DaCgYKAbgSARISFQHGX2Mi5cqs_gOfmw0_ktqFPbXXpQ0175"

!echo -e "Downloading Create Patches Files..."
!curl -H "Authorization: Bearer {ACCESS_TOKEN}" https://www.googleapis.com/drive/v3/files/{CREATE_PATCH_FID}?alt=media -o output_{BATCH_NUMBER}_create_patches.zip

!echo -e "\nUnzipping Create Patches Files..."
!mkdir output_{BATCH_NUMBER}
!unzip -q output_{BATCH_NUMBER}_create_patches.zip -d output_{BATCH_NUMBER}

!echo -e "Downloading Extract Patches Files..."
!curl -H "Authorization: Bearer {ACCESS_TOKEN}" https://www.googleapis.com/drive/v3/files/{EXTRACT_PATCH_FID}?alt=media -o output_{BATCH_NUMBER}_extract_patches.zip

!echo -e "\nUnzipping Extract Patches Files..."
!unzip -q output_{BATCH_NUMBER}_extract_patches.zip -d output_{BATCH_NUMBER}

!echo -e "\nDeleting Extra Files..."
!rm -rf output_{BATCH_NUMBER}_create_patches.zip
!rm -rf output_{BATCH_NUMBER}_extract_patches.zip

!python "prostate-cancer-thesis/scripts/extract_features.py" --encoder "resnet50" --output-base-directory "output_{BATCH_NUMBER}" --dataset-base-directory "prostate-cancer-thesis" --dataset-info-file-name "train.csv" --patch-size 256

!rm -rf output_{BATCH_NUMBER}/create_patches
!rm -rf output_{BATCH_NUMBER}/extract_patches

!echo "Creating ZIP File For Batch # {BATCH_NUMBER}"
!cd output_{BATCH_NUMBER}; zip -qr -1 "output_{BATCH_NUMBER}.zip" . ; mv "output_{BATCH_NUMBER}.zip" .. ; echo "ZIP File Created For Batch # {BATCH_NUMBER}"

!echo "Removing Directory For Batch # {BATCH_NUMBER}"
!rm -r "output_{BATCH_NUMBER}"; echo "Directory Removed For Batch # {BATCH_NUMBER}"